{% comment %}
Partial per mostrare l'immagine di un annuncio con gestione moderazione.

Parametri richiesti:
- annuncio: L'oggetto Annuncio
- css_class: Classi CSS per l'immagine (es: "img-fluid rounded")
- show_pending: Se True, mostra l'immagine anche se pending (solo per owner)

Esempio uso:
{% include 'scambi/partials/annuncio_image.html' with annuncio=annuncio css_class="img-fluid rounded" %}
{% endcomment %}

{% if annuncio.immagine and annuncio.moderation_status == 'pending' %}
    {% comment %}Immagine in moderazione{% endcomment %}
    {% if user.is_authenticated and user == annuncio.utente %}
        {% comment %}Proprietario: mostra avviso e placeholder{% endcomment %}
        <div class="text-center">
            <div class="alert alert-warning mb-3" role="alert">
                <i class="fas fa-clock me-2"></i>
                <strong>⏳ Immagine in attesa di moderazione</strong>
                <br>
                <small>Riceverai una notifica quando sarà approvata</small>
            </div>
            <div class="bg-light border rounded d-flex align-items-center justify-content-center" style="min-height: 300px;">
                <div class="text-muted">
                    <i class="fas fa-image fa-3x mb-3 d-block"></i>
                    <p class="mb-0">In attesa di approvazione</p>
                </div>
            </div>
        </div>
    {% else %}
        {% comment %}Altri utenti: placeholder generico (senza dire che è in moderazione){% endcomment %}
        <div class="bg-light border rounded d-flex align-items-center justify-content-center {{ css_class }}" style="min-height: 300px;">
            <div class="text-muted">
                <i class="fas fa-image fa-3x mb-3 d-block"></i>
                <p class="mb-0">Nessuna immagine</p>
            </div>
        </div>
    {% endif %}
{% elif annuncio.immagine %}
    {% comment %}Immagine approvata: mostra normalmente{% endcomment %}
    <img src="{{ annuncio.get_image_url }}"
         alt="{{ annuncio.titolo }}"
         class="{{ css_class }}"
         loading="lazy">
{% else %}
    {% comment %}Nessuna immagine{% endcomment %}
    <div class="bg-light border rounded d-flex align-items-center justify-content-center {{ css_class }}" style="min-height: 300px;">
        <div class="text-muted">
            <i class="fas fa-image fa-3x mb-3 d-block"></i>
            <p class="mb-0">Nessuna immagine</p>
        </div>
    </div>
{% endif %}

<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ oggetto }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Mobile fullscreen */
        @media only screen and (max-width: 600px) {
            .mobile-container {
                padding: 0 !important;
            }
            .mobile-card {
                border-radius: 0 !important;
                box-shadow: none !important;
                min-height: 100vh !important;
            }
            .mobile-content {
                padding: 80px 30px !important;
                min-height: calc(100vh - 200px) !important;
            }
            .mobile-title {
                font-size: 30px !important;
            }
            .mobile-text {
                font-size: 20px !important;
                line-height: 2 !important;
            }
            .mobile-signature {
                font-size: 18px !important;
            }
        }
    </style>
</head>
<body style="margin: 0; padding: 0; font-family: 'Roboto', 'Arial', sans-serif; background-color: #ffffff;">
    <!-- Container centrato verticalmente -->
    <table role="presentation" style="width: 100%; height: 100%; border-collapse: collapse; min-height: 100vh; background-color: #f4f4f4;">
        <tr>
            <td align="center" valign="top" style="padding: 40px 20px;" class="mobile-container">
                <!-- Card newsletter -->
                <table role="presentation" style="width: 600px; max-width: 100%; border-collapse: collapse; background-color: #ffffff; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; min-height: 600px;" class="mobile-card">

                    <!-- Header con logo e gradiente blu Polygonum -->
                    <tr>
                        <td style="background: linear-gradient(135deg, #4169E1 0%, #2E4BC7 100%); padding: 10px 30px;">
                            <table role="presentation" style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="vertical-align: middle; text-align: left;">
                                        <img src="https://polygonum.io/static/img/polygonum-logo.png" alt="POLYGONUM" style="height: 24px; width: auto; vertical-align: middle; margin-right: 12px; display: inline-block;">
                                        <span style="color: #ffffff; font-size: 1.5rem; font-weight: 500; font-family: 'Roboto', sans-serif; vertical-align: middle; display: inline-block;">POLYGONUM</span>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <!-- Contenuto principale -->
                    <tr>
                        <td style="padding: 60px 30px; min-height: 400px;" class="mobile-content">
                            <h2 style="margin-top: 0; font-size: 26px; font-family: 'Roboto', sans-serif;" class="mobile-title">
                                <span style="color: #000000; font-weight: 400;">Ciao</span>
                                <a href="{{ profilo_url }}" style="color: #4169E1; font-weight: 600; text-decoration: none;">{{ nome_utente }}</a><span style="color: #000000; font-weight: 400;">!</span>
                            </h2>

                            <div style="color: #333333; font-size: 18px; line-height: 1.8; margin-bottom: 40px;" class="mobile-text">
                                {{ messaggio|safe }}
                            </div>

                            <!-- Firma -->
                            <p style="color: #666666; font-size: 16px; margin-top: 30px; font-family: 'Roboto', sans-serif;" class="mobile-signature">
                                A presto,<br>
                                <strong style="color: #4169E1;">Il team di Polygonum</strong>
                            </p>

                            <!-- CTA Pubblica Annuncio -->
                            <table role="presentation" style="margin: 40px 0 30px 0; width: 100%;">
                                <tr>
                                    <td style="text-align: center;">
                                        <a href="{{ crea_annuncio_url }}"
                                           style="background: linear-gradient(135deg, #4169E1 0%, #2E4BC7 100%);
                                                  color: #ffffff;
                                                  padding: 18px 50px;
                                                  text-decoration: none;
                                                  border-radius: 8px;
                                                  font-weight: bold;
                                                  font-size: 16px;
                                                  font-family: 'Roboto', sans-serif;
                                                  display: inline-block;
                                                  box-shadow: 0 4px 8px rgba(65, 105, 225, 0.4);">
                                            Pubblica un annuncio
                                        </a>
                                    </td>
                                </tr>
                            </table>

                            <!-- Tip della settimana -->
                            {% if tip %}
                            <div style="background: linear-gradient(135deg, #E8F0FE 0%, #D6E4FF 100%); padding: 20px; border-radius: 8px; border-left: 4px solid #4169E1; margin: 30px 0;">
                                <h4 style="color: #4169E1; font-size: 16px; font-family: 'Roboto', sans-serif; margin: 0 0 10px 0; font-weight: 700; letter-spacing: 0.5px;">
                                    TIPS
                                </h4>
                                <p style="color: #333333; font-size: 14px; margin: 0; line-height: 1.6;">
                                    <strong>{{ tip.titolo }}</strong><br>
                                    {{ tip.testo }}
                                </p>
                            </div>
                            {% endif %}

                            <!-- Annunci in evidenza -->
                            {% if annunci_evidenza %}
                            <div style="margin: 50px 0 30px 0;">
                                <h3 style="color: #4169E1; font-size: 20px; font-family: 'Roboto', sans-serif; margin-bottom: 20px;">
                                    Annunci in evidenza
                                </h3>
                                <table role="presentation" style="width: 100%; border-collapse: collapse;">
                                    <tr>
                                        {% for annuncio in annunci_evidenza %}
                                        {% if forloop.counter0 < 4 %}
                                        <td style="width: 25%; padding: 10px; vertical-align: top;">
                                            <a href="{{ annuncio.url }}" style="text-decoration: none; display: block;">
                                                <img src="{{ annuncio.thumbnail_url }}" alt="{{ annuncio.titolo }}"
                                                     style="width: 100%; height: 120px; object-fit: cover; border-radius: 8px; margin-bottom: 8px;">
                                                <p style="color: #333333; font-size: 14px; margin: 0 0 4px 0; font-weight: 500; line-height: 1.3;">
                                                    {{ annuncio.titolo|truncatechars:40 }}
                                                </p>
                                                <p style="color: #999999; font-size: 12px; margin: 0;">
                                                    {{ annuncio.username }}
                                                </p>
                                            </a>
                                        </td>
                                        {% endif %}
                                        {% endfor %}
                                    </tr>
                                </table>
                            </div>
                            {% endif %}

                            <!-- CTA Tutti gli annunci -->
                            <table role="presentation" style="margin: 50px 0 30px 0; width: 100%;">
                                <tr>
                                    <td style="text-align: center;">
                                        <a href="{{ base_url }}/annunci/"
                                           style="background: linear-gradient(135deg, #4169E1 0%, #2E4BC7 100%);
                                                  color: #ffffff;
                                                  padding: 18px 50px;
                                                  text-decoration: none;
                                                  border-radius: 8px;
                                                  font-weight: bold;
                                                  font-size: 16px;
                                                  font-family: 'Roboto', sans-serif;
                                                  display: inline-block;
                                                  box-shadow: 0 4px 8px rgba(65, 105, 225, 0.4);">
                                            Tutti gli annunci
                                        </a>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <!-- Footer -->
                    <tr>
                        <td style="background-color: #f9f9f9; padding: 30px; text-align: center; border-top: 1px solid #e0e0e0;">
                            <p style="color: #999999; font-size: 14px; margin: 0 0 10px 0;">
                                Hai ricevuto questa email perché sei registrato su Polygonum
                            </p>
                            <p style="color: #999999; font-size: 14px; margin: 0 0 10px 0; font-family: 'Roboto', sans-serif;">
                                <a href="https://polygonum.io" style="color: #4169E1; text-decoration: none;">polygonum.io</a>
                                •
                                <a href="https://polygonum.io/note-legali/" style="color: #4169E1; text-decoration: none;">Note Legali</a>
                                •
                                <a href="https://polygonum.io/termini-condizioni/" style="color: #4169E1; text-decoration: none;">Termini e Condizioni</a>
                            </p>
                            <p style="color: #999999; font-size: 13px; margin: 0; font-family: 'Roboto', sans-serif;">
                                Non vuoi più ricevere queste email?
                                <a href="{{ unsubscribe_url }}" style="color: #6c757d; text-decoration: underline;">Disiscriviti qui</a>
                            </p>
                        </td>
                    </tr>

                </table>
            </td>
        </tr>
    </table>
</body>
</html>
